name: Notify Hub on Content Update

on:
  push:
    branches: [main]
    paths:
      - 'content/**'
  workflow_dispatch:

jobs:
  notify-infotecha-hub:
    runs-on: ubuntu-latest
    
    steps:
    - name: Notify infotecha hub
      uses: peter-evans/repository-dispatch@v3
      with:
        token: ${{ secrets.PAT_TOKEN }}
        repository: info-tech-io/infotecha
        event-type: module-updated
        client-payload: |
          {
            "module_name": "linux_professional",
            "content_repo": "mod_linux_professional",
            "updated_at": "${{ github.event.head_commit.timestamp }}",
            "commit_sha": "${{ github.sha }}",
            "commit_message": "${{ github.event.head_commit.message }}"
          }
          
    - name: Log notification
      run: |
        echo "ğŸš€ Notified infotecha hub about linux_professional module update"
        echo "ğŸ“¦ Repository: mod_linux_professional" 
        echo "ğŸ”„ Commit: ${{ github.sha }}"
        echo "â° Timestamp: ${{ github.event.head_commit.timestamp }}"